function blur(){timeout=setTimeout(function(){$("body").children("*:not(script, style, .ontab)").each(function(){$(this).addClass("ontab-blur")})},75)}function getCenterTopTarget(t){return parseInt(t.offset().top-$(window).scrollTop())+parseInt(.5*t.height())}function getCenterLeftTarget(t){return parseInt(t.offset().left)+parseInt(.5*t.width())}function blurOut(){clearTimeout(timeout),$(".ontab-blur").removeClass("ontab-blur")}function closePanel(t,e){"1"===t.attr("data-minimize")&&(t.attr("data-minimize",0),reazusteMinimalize()),t.remove(),setTimeout(function(){panelScrool(e)},1)}function stop(t,e){return $(document).off("mousemove mouseup"),dragResizeModule(t,e)}function dragResizeAction(t,e,i,a,n,o){e.on("mousedown",{e:t,k:i},function(i){t.css({"transition-duration":"0s","z-index":getLastIndex(t)});var s=0,r={x:event.pageX,y:event.pageY},d=i.data,c={},l=d.e;if("relative"!==l.css("position"))try{l.position(c)}catch(t){}var m={h:e,X:c.left||getInt(l,"left")||0,Y:c.top||getInt(l,"top")||0,W:getInt(l,"width")||l[0].scrollWidth||0,H:getInt(l,"height")||l[0].scrollHeight||0,pX:i.pageX,pY:i.pageY,k:d.k,o:l};return $(document).mousemove(function(e){s<1&&(e.pageX>r.x+12||e.pageX<r.x-12||e.pageY>r.y+12||e.pageY<r.y-12)&&(s=1),"1"===t.attr("data-maximize")&&1===s&&(t.attr("data-maximize",0).css({"transition-duration":"0s",width:parseInt(t.attr("data-width"))+"px",height:parseInt(t.attr("data-height"))+"px"}).find(".ontab-content").css("height",parseInt(t.attr("data-height"))-45+"px"),a&&resize(t,t.find(".ontab-resize").css("cursor","se-resize"),a,n,o));var i=dragResizeModule(e,m);l.css(i),"r"===m.k&&l.find(".ontab-content").css({height:i.height-45})}).mouseup(function(e){if(1===s){var i=stop(e,m);l.css(i),"r"===m.k?(l.find(".ontab-content").css({height:i.height-45}),n&&n()):o&&o(),s=0}else stop(e,m),"1"===t.attr("data-maximize")&&t.css({top:"-1px",left:0})}),!1})}function resize(t,e,i,a,n){dragResizeAction(t,e,"r",i,a,n)}function minimizePanelOut(t,e,i,a,n,o){t.find(".ontab-header").off("click"),t.attr("data-minimize",0),"1"===t.attr("data-maximize")?maximizePanelIn(t,a):(t.css({top:parseInt(t.attr("data-top"))+"px",left:parseInt(t.attr("data-left"))+"px",width:parseInt(t.attr("data-width"))+"px",height:parseInt(t.attr("data-height"))+"px"}),panelScrool(i)),"1"===t.attr("data-drag")&&dragResizeAction(t,t.find(".ontab-header"),"d",a,n,o),reazusteMinimalize(),setTimeout(function(){t.css("transition-duration","0s")},1e3*e)}function minimizePanelIn(t,e,i){"0"===t.attr("data-maximize")&&storePosition(t);var a=0;$(".ontab").each(function(){"1"===$(this).attr("data-minimize")&&(a+=parseInt($(this).css("min-width")))}),t.attr("data-minimize",1).css({"transition-duration":e+"s",top:wht-30+"px",left:a,width:0,height:0}),panelScrool(i)}function maximizePanelOut(t,e,i,a,n){t.attr("data-maximize",0).css({"transition-duration":e+"s",width:parseInt(t.attr("data-width"))+"px",height:parseInt(t.attr("data-height"))+"px",top:parseInt(t.attr("data-top"))+"px",left:parseInt(t.attr("data-left"))+"px"}).find(".ontab-content").css("height",parseInt(t.attr("data-height"))-45+"px"),setTimeout(function(){t.css("transition-duration","0s")},1e3*e),i&&resize(t,t.find(".ontab-resize").css("cursor","se-resize"),i,a,n)}function maximizePanelIn(t,e,i){"1"===t.attr("data-minimize")&&storePosition(t),t.attr("data-maximize",1).css({"transition-duration":e+"s",width:"100%",height:"100%",top:"-1px",left:"0"}).find(".ontab-content").css("height",wht-45+"px"),i&&t.find(".ontab-resize").off("mousedown").css("cursor","initial")}function dragResizeModule(t,e){if("d"===e.k){var i=e.X+t.pageX-e.pX,a=e.Y+t.pageY-e.pY;return i=i<0?0:i,a=a<-1?-1:a,(0!==i||a>-1)&&"0"===e.o.attr("data-maximize")&&(e.o.attr("data-left",i),e.o.attr("data-top",a)),{left:i,top:a}}var n=Math.max(t.pageX-e.pX+e.W,0),o=Math.max(t.pageY-e.pY+e.H,0);return e.o.attr("data-width",wwt<parseInt(e.o.attr("data-left"))+n?wwt-parseInt(e.o.attr("data-left")):n),e.o.attr("data-height",wht<parseInt(e.o.attr("data-top"))+o+3?wht-parseInt(e.o.attr("data-top"))-3:o),{width:e.o.attr("data-width"),height:e.o.attr("data-height")}}function storePosition(t){t.attr({"data-width":2+parseInt(t.width()+parseInt(t.css("padding-left"))+parseInt(t.css("padding-right"))),"data-height":2+parseInt(t.height()+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))),"data-top":t.offset().top-$(window).scrollTop(),"data-left":t.offset().left})}function panelScrool(t){var e=!1;$(".ontab").length&&$(".ontab").each(function(){"0"===$(this).attr("data-minimize")&&(e=!0)}),e?($("html").scrollBlock(),t&&blur()):($("html").scrollBlock(!1),t&&blurOut())}function getLastIndex(t){var e=parseInt(t.css("z-index"));return $(".ontab").each(function(){"0"===$(this).attr("data-minimize")&&$(this).attr("id")!==t.attr("id")&&(e=parseInt($(this).css("z-index"))>=e?parseInt($(this).css("z-index"))+1:e)}),e}function reazusteMinimalize(){var t=0;$(".ontab").each(function(){"1"===$(this).attr("data-minimize")&&($(this).css("left",t*parseInt($(this).css("min-width"))),t++)})}function getInt(t,e){return parseInt(t.css(e))||!1}var wwt=parseInt($(window).width()),wht=parseInt($(window).height());$(function(t){t.fn.panel=function(e){var i={id:e.id||Math.floor(1e7*Math.random()),drag:function(t,e){dragResizeAction(t,e,"d",a.resize,a.onResize,a.onDrag)},minimize:function(t){"1"===t.attr("data-minimize")?minimizePanelOut(t,a.speed,a.blur,a.resize,a.onResize,a.onDrag):(minimizePanelIn(t,a.speed,a.blur),setTimeout(function(){t.find(".ontab-header").off("mousedown").on("click",function(){i.minimize(t)})},1e3*a.speed))},maximize:function(t){"1"===t.attr("data-maximize")?maximizePanelOut(t,a.speed,a.resize,a.onResize,a.onDrag):maximizePanelIn(t,a.speed,a.resize),panelScrool(a.blur)},close:function(t){closePanel(t,a.blur)}},a={drag:!0,resize:!0,minimize:!0,maximize:!0,close:!0,onClose:!1,onMinimize:!1,onMaximize:!1,onDrag:!1,onResize:!1,speed:.25,blur:!0,clickOut:!1};t.extend(a,e.control);var n={top:parseInt(wht*(wwt<900?wwt<500?0:.025:.05)),left:parseInt(wwt*(wwt<900?wwt<500?0:.075:.15)),width:parseInt(wwt*(wwt<900?wwt<500?1:.85:.7)),height:parseInt(wht*(wwt<900?wwt<500?1:.95:.9)),"z-index":1,"transition-duration":1.3*a.speed+"s","border-radius":0,"min-width":190,"max-width":wwt,"min-height":30,"max-height":wht};t.extend(n,e.css);var o={"data-drag":!0===a.drag?1:0,"data-top":n.top,"data-left":n.left,"data-width":n.width,"data-height":n.height};a.minimize&&(o["data-minimize"]=0),a.maximize&&(o["data-maximize"]=0),t.extend(o,e.attr),o.id=i.id;var s={html:"",css:{padding:0}};t.extend(s,e.header);var r={html:"",css:{padding:0,height:parseInt(n.height)-45}};r=t.extend(!0,{},r,e.body);var d=t("<div />").attr(o).addClass("ontab").css({left:getCenterLeftTarget(e.target?e.target:this),top:getCenterTopTarget(e.target?e.target:this)}).appendTo("body");setTimeout(function(){d.css(n)},1);var c=t("<div />").addClass("ontab-header").css(s.css).prependTo(d);if(t("<div />").addClass("title").text(s.html).css("background",c.css("background")).prependTo(c),t("<div />").addClass("ontab-content").css(r.css).html(r.html).prependTo(d),a.minimize&&t("<div />").addClass("ontab-button btn-ontab-mini").attr("title","minimizar").text("-").prependTo(c).on("click",function(){a.onMinimize?a.onMinimize()||i.minimize(d):i.minimize(d)}),a.maximize){var l=t("<div />").addClass("ontab-button btn-ontab-maxi").attr("title","maximizar").html("<div class='maxi'></div>").prependTo(c);c.on("dblclick",function(){i.maximize(d)}),l.on("click",function(){a.onMaximize?a.onMaximize()||i.maximize(d):i.maximize(d)})}if(a.close&&t("<div />").addClass("ontab-button btn-ontab-close").attr("title","fechar").text("x").prependTo(c).on("click",function(){a.onClose?a.onClose()||i.close(d):i.close(d)}),a.drag&&i.drag(d,c),a.resize){var m=t("<div />").addClass("ontab-resize").appendTo(d);resize(d,m,a.resize,a.onResize,a.onDrag)}d.css("z-index",getLastIndex(d)).on("mousedown",function(){t(this).css("z-index",getLastIndex(t(this)))}),panelScrool(a.blur),a.clickOut&&t(document).on("mousedown",function(t){d.is(t.target)||0!==d.has(t.target).length||"0"===d.attr("data-minimize")&&("minimize"===a.clickOut?i.minimize(d):i.close(d))})},t.fn.scrollBlock=function(e){void 0===e||e?(window.oldScrollPos=t(window).scrollTop(),t(window).on("scroll.scrolldisabler",function(e){t(window).scrollTop(window.oldScrollPos),e.preventDefault()})):t(window).off("scroll.scrolldisabler")}}(jQuery));var timeout;$("#btnt").on("click",function(){$(document).panel()});